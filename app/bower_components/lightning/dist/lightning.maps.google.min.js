/*! lightning 2017-05-08 */
!function(){"use strict";function a(a,b){return{restrict:"E",scope:{response:"=",options:"=?"},transclude:!0,link:function(c,d,e){var f=!1;e.scrollToZoom="true"==e.scrollToZoom,a.then(function(){c.$watch("response",function(a){if(a){if(c.facet=c.response.facets[e.facetName],null==c.facet)return;if(f){if(null!=c.heatLayer){var d=[],g=new google.maps.LatLngBounds;angular.forEach(c.facet.filters,function(a){var c=b("actualValue")(a.val),e=c.split(","),f=e[0].trim(),h=e[1].trim();f=parseFloat(f),h=parseFloat(h);var i=new google.maps.LatLng(f,h);g.extend(i);var j={};j.location=i,j.weight=a.count,d.push(j)}),c.heatLayer.setData(d),c.googleBounds=g;var h=c.googlemap.getGMap();google.maps.event.trigger(h,"resize"),h.fitBounds(c.googleBounds)}}else c.mapOptions={scrollwheel:e.scrollToZoom},null!=c.options&&angular.extend(c.mapOptions,c.options),c.googlemap={},c.map={center:{latitude:38.9,longitude:-77.016},zoom:13,showHeat:!0,heatLayerCallback:function(a){var d=[],e=new google.maps.LatLngBounds;angular.forEach(c.facet.filters,function(a){var c=b("actualValue")(a.val),f=c.split(","),g=f[0].trim(),h=f[1].trim();g=parseFloat(g),h=parseFloat(h);var i=new google.maps.LatLng(g,h);e.extend(i);var j={};j.location=i,j.weight=a.count,d.push(j)}),a.setData(d),c.googleBounds=e;var g=c.googlemap.getGMap();google.maps.event.trigger(g,"resize"),g.fitBounds(c.googleBounds),f=!0,c.heatLayer=a}}}})})},template:function(a,b){var c=Math.floor(1e3*Math.random()+1);b.height=null==b.height?"400px":b.height,b.width=null==b.width?"100%":b.width;var d="<style>.map"+c+" .angular-google-map-container{height:"+b.height+"; width:"+b.width+';}</style><div class="map'+c+'" style="height:'+b.height+"; width:"+b.width+'; position:relative;" ng-if="response != null"><ui-gmap-google-map center="map.center" zoom="map.zoom" options="mapOptions" control="googlemap" ng-if="map != null"><ui-gmap-layer namespace="visualization" type="HeatmapLayer" show="map.showHeat" onCreated="map.heatLayerCallback"></ui-gmap-layer></ui-gmap-google-map></div>';return d}}}angular.module("lightning").directive("geoHeatmap",a),a.$inject=["uiGmapGoogleMapApi","$filter"]}();